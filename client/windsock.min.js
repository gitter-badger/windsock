!function(){"undefined"==typeof module&&(_exports=Object.create(null),module={set exports(e){if("[object Function]"==Object.prototype.toString.call(e)){var t=e._ns||e.toString().match(/function ([^\(]*)/)[1].toLowerCase();_exports[t]=e}else{if(!e._ns)throw new Error("Export namespace missing");_exports[e._ns]=_exports[e._ns]||{};for(var n in e)_exports[e._ns][n]=e[n]}},get exports(){return _exports}}),"undefined"==typeof require&&(require=function(e){return module.exports[e.match(/[^\/]+$/).join()]});var e={client:"undefined"!=typeof document,debug:!0};Object.defineProperty(e,"_ns",{value:"config",enumerable:!1}),module.exports=e}(),function(){"use strict";var e=require("./config"),t=(this.window,this.requestAnimationFrame||this.setTimeout),n="undefined"!=typeof process&&process.nextTick?process.nextTick:t,r={log:function(t){e.debug&&console&&console.log(t)},nextTick:function(e){n(e,0)},each:function(e,t,n){n=n||this;var r=Array.prototype.slice.call(arguments,3),o=Object.create(null);if(e.length){for(var i=0,s=e.length;s>i;i++)if(t.apply(n,[e[i],i,e,o].concat(r))==o)return}else for(var a in e)if(t.apply(n,[e[a],a,e,o].concat(r))==o)return},traverse:function(e,t,n){n=n||this;var o=Array.prototype.slice.call(arguments,3);r.each(e,function(){for(var e=t.apply(this,Array.prototype.slice.call(arguments)),i=0;2>i;)arguments[i]instanceof Object&&!arguments[i].call&&r.traverse(arguments[i],t,n,o),i++;return e},n,o)},set:function(e,t){var n=Array.prototype.slice.call(arguments,2);return n.length?Object.defineProperty(e,t,n[0]):Object.defineProperties(e,t)},merge:function(e){return r.each(Array.prototype.slice.call(arguments,1),function(t){for(var n in t)e.hasOwnProperty(n)&&(e[n]=t[n])}),e},inherit:function(e,t,n){return e.prototype&&t.prototype&&(e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e),e},extend:function(e){return r.each(Array.prototype.slice.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},match:function(e,t){var n=!0;return r.each(t,function(t,r){e[r]!==t&&(n=!1)}),n},bind:function(e,t){return function(){return e.apply(t,Array.prototype.slice.call(arguments))}},is:function(e,t){return Object.prototype.toString.call(e)==="[object "+r.upperCase(t)+"]"},upperCase:function(e){return e.replace(/[a-z]/,function(e){return e.toUpperCase()})},isClient:function(){return e.client},isEmpty:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}};Object.defineProperty(r,"_ns",{value:"util",enumerable:!1}),module.exports=r}.call(this),function(){"use strict";function e(){this._callbacks=[]}function t(){}function n(t){var n=this;return n._callbacks=Array.prototype.slice.call(arguments,1),o(n._callbacks[0],"array")&&(n._callback=n._callback[0]),n._index=0,n._config=s({async:!0,flowing:!1},t),i(function(){if(!n._callbacks.length)return{then:function(e){u(e)}};var t=new e(n._config.async),r=Array.prototype.slice.call(arguments),o=function(){n._index++,n._index===n._callbacks.length?(a(t._callbacks,function(e){e.call(n)},n),a(n._callbacks,function(e){e._flush.apply(e,r)}),n._index=0):n._config.async?u(i):i()},i=function(){var e=n._callbacks[n._index];return e._signal.apply(e,r),n._config.flowing&&o(),n};return n._config.flowing||r.push(o),n._config.async?(u(i),t):i()},n)}var r=require("./util"),o=r.is,i=r.extend,s=r.merge,a=r.each,c=r.inherit,u=r.nextTick;module.exports=n,n.Promise=e,n.Signal=t,e.prototype.then=function(e){return o(e,"function")&&this._callbacks.push(e),this},t.prototype._signal=function(){},t.prototype._flush=function(){},t.extend=function(e,n){var r=function(){t.call(this),n&&n.apply(this,arguments)};return c(r,t),i(r.prototype,e),r},n.prototype.add=function(e){if(!(e instanceof t||e._signal))throw new Error("add() requires an instance of Signal");return this._callbacks.push(e),this},n.prototype.remove=function(e){if(e){if(o(e,"number"))return this._callbacks.splice(e,1),this;if(!(e instanceof t||e._signal))throw new Error("remove() requires an instance of Signal");a(this._callbacks,function(t,n,r,o){return t===e?(r.splice(n,1),o):void 0})}else this._callbacks=[];return this}}(),function(){"use strict";function e(e){var t=this;t.options=o.merge({async:!1,flowing:!0},e),i(["start","content","end","done"],function(e){t[e]=new r(t.options)})}function t(e){for(var t={nodeName:"",attributes:{}},n=/(([\w\-]+([\s]|[\/>]))|([\w\-]+)="([^"]+)")/g,r=e.match(n),o=0,i=r.length;i>o;o++){var s=r[o].split("=");0===o?t.nodeName=s[0].replace("/","").replace(">","").trim():t.attributes[s[0]]=s.length>1?s[1].replace('"',"").replace('"',""):null}return t}function n(e){for(var t=0,n=a.length;n>t;t++)if(a[t]===e)return!0;return!1}var r=require("./signals"),o=require("./util"),i=o.each,s=o.is,a=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];module.exports=e,e.prototype.parseDOM=function(e){if("SCRIPT"!==e.nodeName){var t={};if(i(e.attributes,function(e){t[e.nodeName]=e.nodeValue}),e.hasChildNodes())for(var n=e.childNodes,r=0;r<n.length;r++)1==n[r].nodeType||3==n[r].nodeType;return this.parseHTML.done()}},e.build=function(t,n){var r=function(){};return inherit(r,e),new e(n)},e.prototype.parse=function(e){return e?s(e,"string")?this.parseHTML(e):e.nodeName?this.parseDOM(e):this.parseJSONML(e):void 0},e.prototype.parseJSONML=function(e){this.content(e)},e.prototype.parseHTML=function(e){if(e){for(e=e.toString().replace(/\n/g,"").replace(/\r/g,"");e;){var r=e.indexOf("<");if(r>=0){this.content(e.substring(0,r)),e=e.substring(r);var o=e.indexOf(">")+1,i=e.substring(0,o),s=t(i),a="/"===e[i.length-2]||n(s.nodeName);"!"===i[1]?o=e.indexOf("-->")+1:"/"===i[1]||a?this.end(s,a):this.start(s),e=e.substring(o)}else this.content(e),e=null}return this.done()}}}(),function(){"use strict";function e(e){var t=new o.Signal.extend({context:null,_signal:function(){e.apply(this.context,arguments)}});return new t}function t(e){a(this,e),this.observers=new o({async:!1,flowing:!0})}function n(e){return c(e,function(){var e=arguments[2],r=arguments[1],o=arguments[0],a=[];e._observable||s(e,{_observable:{writable:!0,enumerable:!1,value:Object.create(null)}}),e._observable[r]&&(a=a.concat(e._observable[r].list())),s(e._observable,r,{writable:!0,enumerable:!0,value:new t({value:o,parent:e})}),u(a,function(t){e._observable[r].add(t)}),s(e,r,{set:function(t){(i(t,"array")||i(t,"object"))&&n(t),e._observable[r].value=t,e._observable[r].emit("set",r,e)},get:function(){return e._observable[r].emit("get",r,e),e._observable[r].value}})}),e}var r=require("./util"),o=require("./signals"),i=r.is,s=r.set,a=r.extend,c=r.traverse,u=r.each;t.prototype.add=function(e){e.context=this,this.observers.add(e)},t.prototype.list=function(){return this.observers._callbacks},t.prototype.remove=function(e){this.observers.remove(e)},t.prototype.emit=function(){this.observers.apply(void 0,arguments)},n.Observer=e,n.Subject=t,n.mutate=function(e,t,r){if(!e._observable)throw new Error("Object is non mutatable. Missing observers.");var o=r(e[t]);e[t]={asd:"asd"},console.log(e[t].prop),o&&(e[t]._observable[o].remove(),e[t]._observable[o]=void 0),n(e[t]),e._observable[t].emit("mutate",t,e)},n.observe=function(t,n,r){if(!t._observable||!t._observable[n])throw new Error('Observable key "'+n+'" does not exist');t._observable[n].add(new e(r))},n.proxy=function(e,t,r){n(t),u(t,function(n,o){var i=o;r&&r[o]&&(i=r[o]),s(e,i,{set:function(e){t[o]=e},get:function(){return t[o]}})})},module.exports=n}(),function(){"use strict";function e(e,r){s(this.options,r),this._selection=this._jsonml=[];var o=new t(this.options.parser),i=n.Signal.extend({markup:this},function(e){this._signal=e}),a=new i(function(e,t){t||"undefined"==typeof t?t?this.markup.append(e):this.markup.insert(e):this.markup.parent()}),c=new i(function(e){e.length&&this.markup.append(e)});o.start.add(a),o.content.add(c),o.end.add(a),o.parse(e)}var t=require("./parser"),n=require("./signals"),r=require("./util"),o=r.is,i=r.each,s=r.merge,a=r.extend,c=r.traverse;e.prototype.options={parser:{async:!1,flowing:!0}},e.prototype.each=function(e){var t=Array.prototype.slice(arguments,1);return i.apply(this,[this._selection,e].concat(t)),this},e.prototype.traverse=function(e,t){return t=t||this._selection,c.call(this,t,e),this},e.prototype.append=function(e){this._selection.push(this.convert(e))},e.prototype.insert=function(e,t){var n=o(e,"object")?this.convert(e):e,r=0;return t&&t>0?(Array.prototype.splice.call(this._selection,t,0,n),r=this._selection.length-1):r=Array.prototype.push.call(this._selection,n)-1,o(n,"array")&&(this._selection=this._selection[r]),this},e.prototype.convert=function(e){if(o(e,"string")||o(e,"array"))return e;var t=[];return t[0]=e.nodeName,e.attributes&&!r.isEmpty(e.attributes)&&(t[1]=e.attributes),t},e.prototype.find=function(t){if(o(t,"number"))return this._selection=this._selection[t],this;if(!t)return this._selection=this._jsonml,this;var n=Array.prototype.slice.call(arguments),i={nodeName:"",attributes:{}};n.length>1?i.attributes[n[0]]=i.attributes[n[1]]:o(t,"string")?i.nodeName=t:o(t,"object")&&a(i,t);var s=new e;return this.traverse(function(e,t,n){if(!(t>0||o(n,"object")||(console.log("matching"),console.log(n),console.log(i),i.nodeName.length&&n[0]!==i.nodeName)))if(r.isEmpty(i.attributes))s.append(n),console.log("match");else{if(!o(n[1],"object"))return;r.match(n[1],i)&&(s.append(n),console.log("match"))}},this._jsonml),s._jsonml.length?s:this},e.prototype.replace=function(e){return this._selection=e,this},e.prototype.children=function(t,n){t=t||this._selection,n=n||function(){return!0};var r=[];return i(t,function(e){o(e,"array")&&n.call(this,e)&&r.push(e)},this),new e(r,this.options)},e.prototype.parent=function(){return this.traverse(function(e,t,n,r){if(!(t>0)){var o=this.children(n,function(e){return e==this._selection?!0:!1});return o._jsonml.length?(this._selection=n,r):void 0}},this._jsonml),this},e.prototype.jsonml=function(){return this._jsonml},module.exports=e}(),function(){"use strict";function e(t){var o=this,i=o.options={data:Object.create(null),markup:Object.create(null),bindings:e.bindings,selectors:e.selectors};n.proxy(o,i),n.observe(i,"markup",function(e){switch(e){case"set":this.value=new r(this.value)}}),n.observe(i,"data",function(e){switch(e){case"set":}}),t&&u(o,t),e.bind(o.data,o.markup,o.bindings)}var t=require("./util"),n=require("./data"),r=require("./markup"),o=t.is,i=t.inherit,s=t.extend,a=t.each,c=t.traverse,u=t.merge;module.exports=this.windsock=e,e.observe=function(e,t,r){n.observe(e,t,r)},e.prototype.observe=function(e,t){this.data[e]&&n.observe(this.data,e,t)},e.prototype.find=function(e){return this.markup.find(e)},e.extend=function(t){var n=function(){e.call(this)};return i(n,e),s(n.prototype,t),n},e.bindings=[{data:function(){return!0},markup:function(){return!0},bind:function(){console.log("data changed")},manip:function(){}}],e.selector={data:function(e){return o(this,"string")?e==this?!0:!1:void 0},markup:function(e){return o(this,"string")?e==this?!0:!1:void 0}},e.bind=function(t,n,r){a(r,function(r){c(t,function(t,o,i){e.selector.data.apply(r.data,arguments)&&(console.log("matched data"),c(n,function(){e.selector.markup.apply(r.markup,arguments)&&(console.log("matched markup"),e.observe(i,t,function(e){}))}))})})}}.call(this);