!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.windsock=e.windsock||{})}(this,function(e){"use strict";function t(e){return e.charAt(0).toUpperCase()+e.slice(1)}function r(e,r){switch(r){case"empty":return 0===Object.keys(e).length;case"undefined":return"undefined"==typeof e;case"null":return null===e;default:return Object.prototype.toString.call(e)==="[object "+t(r)+"]"}}function n(e){for(var t=1,r=arguments.length;r>t;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e}function i(e){var t={};return Object.keys(e).forEach(function(n){t[n]=r(e[n],"object")?i(e[n]):e[n]}),t}function o(e,t){for(var r in t)if(e[r]!==t[r])return!1;return!0}function s(){}function a(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n={},i=t.decode||decodeURIComponent;if(!r(e,"string"))throw new Error("Parameter must be a string");return e=t.query?c(e):e,e.split("&").forEach(function(e){e&&(e=e.split("="),n[i(e[0])]=1===e.length?null:i(e[1]))}),n}function u(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=void 0,i=t.encode||encodeURIComponent;if(!r(e,"object"))throw new Error("Parameter must be an object");return n=Object.keys(e).map(function(t){var r=e[t]?"="+i(e[t]):"";return i(t)+r}).join("&"),n.length?t.query?"?"+n:n:""}function c(e){if(!r(e,"string"))throw new Error("Parameter must be a string");return 0===e.indexOf("?")&&(e=e.replace("?","")),e}function l(e){var t={};if(!r(e,"string"))throw new Error("Parameter must be a string");return e=h(e),e&&e.split("/").forEach(function(e,r){0===e.indexOf(":")&&e.length>1&&(t[e.replace(":","")]=r)}),t}function d(e,t){if(!r(t,"object"))throw new Error("Parameter must be an object");for(var n in t){var i=t[n];i=i.toString?i.toString():"",e=e.replace((i.length?":":"/:")+n,i)}return e}function h(e){if(!r(e,"string"))throw new Error("Parameter must be a string");return e.replace(/^\/|\/$/g,"")}function f(e){if(!rt)throw new Error("Unable to parse in enviorment");if(!r(e,"string"))throw new Error("Parameter must be a string");return rt.href=e,{protocol:rt.protocol||null,host:rt.host||null,port:rt.port||null,hostname:rt.hostname||null,hash:rt.hash||null,search:rt.search||null,query:a(rt.search,{query:!0}),pathname:rt.pathname||null,path:l(rt.pathname),href:rt.href}}function v(e){var t=void 0,n=void 0,i=void 0,o=void 0,s=void 0,a=void 0;if(!rt)throw new Error("Unable to format in enviorment");if(!r(e,"object"))throw new Error("Parameter must be an object");return t=e.protocol||"",n=e.host||"",i=d(e.pathname,e.path),o=e.search||"",s=u(e.query,{query:!0}),a=e.hash||"",t+"//"+n+i+(s||o)+a}function p(){for(w()&&y();ct.length;)ct.pop();for(;lt.length;)lt.pop();Object.keys(dt).forEach(function(e){return delete dt[e]}),ht.hash=!0,ht.root="root",ht.reactivate=!1,ht.otherwise=void 0,ht.post=void 0,ft=void 0,vt=void 0,pt=!1,mt=[],bt=void 0}function m(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(C(e))throw new Error("invalid path");if(!r(t,"object"))throw new Error("parameter must be an object");return e=E(e),dt[e]?dt[e].push(t):dt[e]=[t],dt[e]}function b(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=void 0,i=void 0,o=void 0;if(C(e))throw new Error("Invalid path format");if(D(e,t.path))throw new Error("Invalid params for path "+e);return n=E(e),i=dt[n]||r(ht.otherwise,"undefined")?n.split("/"):E(ht.otherwise).split("/"),t.requested=e,t.query=t.query||{},o=new gt(i,t),ct.push(o),pt||Ye(_),o.promise}function g(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.hash,n=e.root,i=e.reactivate,o=e.otherwise,s=e.post;ht.hash=r(t,"undefined")?ht.hash:t,ht.root=r(n,"undefined")?ht.root:n,ht.reactivate=r(i,"undefined")?ht.reactivate:i,ht.otherwise=r(o,"undefined")||C(o)?ht.otherwise:o,ht.post=r(s,"undefined")||!r(s,"function")?ht.post:s,k(function(e){var t=h(ht.hash?location.hash.replace("#",""):location.pathname),r=O(t),n=void 0;if(r){r=r.slice(1).join("/"),t=t.split("/"),n={path:l(r),query:a(location.search,{query:!0}),replace:!0,event:e};for(var i in n.path)n.path[i]=t[n.path[i]];!C(r)&&b(r,n)}}),ft&&ft()}function y(){k()}function w(){return!!ft}function k(e){var t=void 0;if("undefined"!=typeof window)if(t=ht.hash?"hashchange":"popstate",e){if(ft)throw new Error("router already started");ft=e,window.addEventListener(t,ft)}else{if(!ft)throw new Error("router no started");"undefined"!=typeof window&&window.removeEventListener(t,ft),ft=void 0}}function E(e){return""+ht.root+(e?"/"+e:"")}function O(e){var t={literal:0,variable:0},r=void 0;return e=E(e).split("/"),Object.keys(dt).forEach(function(n){var i=n.split("/"),o=void 0;i.length>e.length||(o=j(i,e),0!==o.literal&&(o.literal>t.literal||o.literal===t.literal&&o.variable>t.variable)&&(t=o,r=n))}),r&&(r=r.split("/"),r=r.concat(e.slice(r.length))),r}function j(e,t){for(var r={literal:0,variable:0},n=0,i=e.length;i>n;n++)if(0===e[n].indexOf(":"))r.variable++;else{if(e[n]!==t[n])return r.literal=0,r;r.literal++}return r}function _(){var e=void 0;ct.length?(pt=!0,e=vt,vt=ct.shift(),vt.previous=e,x()):pt=!1}function x(){for(bt=0;bt<vt.segments.length;){if(vt.segments[bt]!==lt[bt])return void V();bt++}V()}function V(){var e=void 0;lt.length-bt>0?(e=dt[lt.join("/")],e?(vt.target=lt.slice(1).join("/"),T(e.map(function(e){return e.deactivate||s})).then(function(){lt.pop(),V()})["catch"](function(e){vt.reject(e),Ye(_)})):(lt.pop(),V())):q()?N():P()}function q(){var e=vt.previous;return ht.reactivate||1===vt.segments.length?!0:e?!(vt.requested!==e.requested||o(vt.query,e.query)&&o(e.query,vt.query)):!1}function N(){var e=void 0;return mt.length<lt.length&&(mt=lt.slice(0,mt.length+1),e=dt[mt.join("/")])?(vt.target=lt.slice(1).join("/"),void T(e.map(function(e){return e.activate||s})).then(N)["catch"](function(e){vt.reject(e),mt=[],Ye(_)})):(mt=[],void P())}function P(){var e=void 0;lt.length<vt.segments.length?(lt.push(vt.segments[lt.length]),e=dt[lt.join("/")],e?(vt.target=lt.slice(1).join("/"),T(e.map(function(e){return e.activate||s})).then(P)["catch"](function(e){vt.reject(e),Ye(_)})):P()):(vt.resolved=vt.toString(),"undefined"!=typeof window&&(vt.replace?"undefined"!=typeof window.history&&window.history.replaceState({},"",(ht.hash?"#/":"/")+vt.resolved):"undefined"!=typeof window.history&&window.history.pushState({},"",(ht.hash?"#/":"/")+vt.resolved)),vt.resolve(vt),ht.post&&ht.post(vt),Ye(_))}function T(e){return e.reduce(function(e,t){return e.then(function(){return t(vt)})},Promise.resolve())}function C(e){return/^\/|[^#]\/$/.test(e)}function D(e,t){var n=l(e),i=Object.keys(n);if(i.length&&(r(t,"undefined")||!r(t,"object")))return!0;for(var o in n)if(r(t[o],"undefined"))return!0;return!1}function S(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return Object.defineProperty(t,"parent",{value:e,enumerable:!1,writable:!1,configurable:!1}),t}function A(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return Object.defineProperty(t,"parent",{value:e,enumerable:!1,writable:!1,configurable:!1}),t}function M(e){return e.html}function I(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return Object.defineProperty(t,"parent",{value:e,enumerable:!1,writable:!1,configurable:!1}),t}function F(e,t){return t.name&&t.name===e}function L(e,t){return t.attributes?o(t.attributes,e):!1}function U(e){if(r(e,"function"))return e;if(r(e,"string"))return F.bind(null,e);if(r(e,"object"))return L.bind(null,e);throw new Error("specified query type not supported")}function R(e){return e instanceof Et}function H(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return Object.defineProperty(t,"parent",{value:e,enumerable:!1,writable:!1,configurable:!1}),t}function z(e){return/\s/.test(e)}function B(e){for(var t=0,r=xt.length;r>t;t++)if(xt[t]===e)return!0;return!1}function J(e){return!/[^\t\n\r ]/.test(e)}function X(e){return e.toString().replace(/[\t\n\r]|\s{2,}/g,"")}function $(e,t){if(e.hasChildNodes())for(var r=e.childNodes,n=0,i=r.length;i>n;n++)W(r[n],t)}function G(e){var t={},r=/(([\w\-:]+([\s]|[\/>]))|([\w\-:]+)=["']([^"']+)["'])/g,n=e.match(r);n.length>1&&(t.attributes={});for(var i=0,o=n.length;o>i;i++){var s=n[i].split("=");0===i?t.name=s[0].replace(/[\/>]/g,"").trim():s.length>1?t.attributes[s[0].trim()]=s[1].replace(/["'>]/g,"").trim():t.attributes[s[0].replace(/[>]/g,"").trim()]=null}return t}function W(e,t){var r;if(-1===Vt.indexOf(e.nodeName.toLowerCase())){if(e instanceof DocumentFragment)return void $(e,t);if(3===e.nodeType){if(J(e.nodeValue)||!X(e.nodeValue).length)return;return t({type:"text",textNode:e,value:X(e.nodeValue)})}r={documentElement:e,name:e.nodeName.toLowerCase(),"void":B(e.nodeName.toLowerCase())},e.attributes.length&&(r.attributes={},Array.prototype.forEach.call(e.attributes,function(e){r.attributes[e.name]=e.value})),r.type="start",r["void"]||t(r),$(e,t),r.attributes&&!r["void"]&&delete r.attributes,r.type="end",t(r)}}function K(e,t){var r,n,i;for(e=X(e);e;){var o=e.indexOf("<");o>=0?(o>0&&t({type:"text",value:e.substring(0,o)}),e=e.substring(o),r=e.indexOf(">")+1,n=e.substring(0,r),i=G(n),i["void"]="/"===e[n.length-2]||B(i.name),"!"===n[1]?r=e.indexOf("-->")+1:"/"===n[1]||i["void"]?(i.type="end",t(i)):(i.type="start",t(i)),e=e.substring(r)):(t({type:"text",value:e}),e=null)}}function Q(e,t){var i,o=1;for((r(e[0],"array")||r(e[0],"object"))&&"undefined"!=typeof e[0].length?Q(e[0],t):(i={name:e[0],"void":B(e[0]),type:"start"},e.length>1&&"[object Object]"===e[1].toString()&&(o++,i.attributes=n({},e[1])),i["void"]||t(i));o<e.length;)r(e[o],"string")||e[o].value?t({type:"text",value:e.value||e[o]}):Q(e[o],t),o++;"undefined"!=typeof i&&(i.attributes&&!i["void"]&&delete i.attributes,i.type="end",t(i))}function Y(e){function t(e){var t;switch(e.type){case"text":i.append(new Et(e.value));break;case"start":t=new jt(e.name,e.attributes),i.append(t),i=t;break;case"end":e["void"]?(t=new jt(e.name,e.attributes,e["void"]),i.append(t)):i.parent&&(i=i.parent)}}var n,i=new Ot;return r(e,"string")?K(e,t):e.nodeName?document.contains(e)?(n=e,W(e.cloneNode(!0),t)):W(e,t):Q(e,t),i=1===i.children.length?i.children[0]:i,i.transclude=n,i}function Z(e,t){var n,i=Tt.recursive(t),o=ne(e);if(e._observers?t.observers.forEach(function(t){e._observers.exists(t)||e._observers.add(t)}):(n={_observers:{value:t,configurable:!1}},o.forEach(function(t){ie(t,e[t],n)}),r(e,"array")?te(e,n):ee(e,n),Object.defineProperties(e,n)),i.observers.length)for(var s=0,a=o.length;a>s;s++)re(e[o[s]])&&Z(e[o[s]],i)}function ee(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];t.add={value:function(e,t){oe(this,e,t)}},t["delete"]={value:function(e){se(this,e)}}}function te(e){for(var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=function(e,r){t[qt[e]]={value:function(){ae({args:Array.prototype.slice.call(arguments),method:qt[e],target:this})}}},n=0,i=qt.length;i>n;n++)r(n,i)}function re(e){return r(e,"array")||r(e,"object")}function ne(e){return Object.getOwnPropertyNames(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).configurable})}function ie(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return r[e]={get:function(){return t},set:function(r){var n=new Pt({type:e,target:this,method:"set",oldValue:t,newValue:r,args:[]});this._observers.recursiveExists()&&re(r)&&Z(r,Tt.recursive(this._observers)),t&&t._observers&&ce(this,t._observers),t=r,this._observers.dispatch(n)},enumerable:!0,configurable:!0},r}function oe(e,t,n){if(!r(e[t],"undefined"))throw new Error("Failed to add "+t+" already defined");var i=new Pt({type:t,target:e,method:"add",oldValue:e[t],newValue:n,args:Array.prototype.slice.call(arguments,1)});e._observers.recursiveExists()&&re(n)&&Z(n,Tt.recursive(e._observers)),Object.defineProperties(e,ie(t,n)),e._observers.dispatch(i)}function se(e,t){if(r(e[t],"undefined"))throw new Error("Failed to delete "+t+" does not exist");var n=new Pt({type:t,target:e,method:"delete",oldValue:e[t],newValue:void 0,args:Array.prototype.slice.call(arguments,1)});e[t]&&e[t]._observers&&ce(e,e[t]._observers),delete e[t],e._observers.dispatch(n)}function ae(e){var t=e.target,r=e.args,n=e.method,i=new Pt({type:void 0,target:t,method:n,oldValue:void 0,newValue:void 0,args:r});switch(n){case"fill":i.type=r.splice(1),i.oldValue=t.slice(r[1],r[2]);break;case"pop":i.type=t.length-1,i.oldValue=t.slice(t.length-1);break;case"push":i.type=t.length,i.newValue=r;break;case"shift":i.type=0,i.oldValue=t.slice(0,1);break;case"unshift":i.type=0,i.newValue=r;break;case"splice":i.type=r[0],r[1]&&(i.oldValue=t.slice(r[0],r[0]+r[1])),i.newValue=r.slice(2)}t._observers.recursiveExists()&&i.newValue.forEach(function(e){re(e)&&Z(e,Tt.recursive(t._observers))}),i.oldValue&&i.oldValue.forEach(function(e){e&&e._observers&&ce(t,e._observers)}),Array.prototype[n].apply(t,e.args),t._observers.dispatch(i)}function ue(e,t){ne(e).forEach(function(r){ue(e[r],t),e[r]._observers&&e[r]._observers.remove(t)})}function ce(e,t){e._observers.recursive().forEach(function(e){t.remove(e)})}function le(){Dt=null,St=!1,Ct.length=0}function de(){for(var e=0;e<Ct.length;e++)Ct[e].call();le()}function he(e){return Ct.push(e),St||(Dt=Ke(de),St=!0),Dt}function fe(e,t){var n,i=Ft.recursive(t),o=be(e);if(e._observers?t.observers.forEach(function(t){e._observers.exists(t)||e._observers.add(t)}):(n={_observers:{value:t,configurable:!1}},o.forEach(function(t){ge(t,e[t],n)}),r(e,"array")?pe(e,n):ve(e,n),Object.defineProperties(e,n)),i.observers.length)for(var s=0,a=o.length;a>s;s++)me(e[o[s]])&&fe(e[o[s]],i)}function ve(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];t.add={value:function(e,t){ye(this,e,t)}},t["delete"]={value:function(e){we(this,e)}}}function pe(e){for(var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=function(e,r){t[At[e]]={value:function(){ke({args:Array.prototype.slice.call(arguments),method:At[e],target:this})}}},n=0,i=At.length;i>n;n++)r(n,i)}function me(e){return r(e,"array")||r(e,"object")}function be(e){return Object.getOwnPropertyNames(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).configurable})}function ge(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return r[e]={get:function(){return t},set:function(r){var n=new It({type:e,target:this,method:"set",oldValue:t,newValue:r,args:[]});this._observers.recursiveExists()&&me(r)&&fe(r,Ft.recursive(this._observers)),t&&t._observers&&Oe(this,t._observers),t=r,this._observers.dispatch(n)},enumerable:!0,configurable:!0},r}function ye(e,t,n){if(!r(e[t],"undefined"))throw new Error("Failed to add "+t+" already defined");var i=new It({type:t,target:e,method:"add",oldValue:e[t],newValue:n,args:Array.prototype.slice.call(arguments,1)});e._observers.recursiveExists()&&me(n)&&fe(n,Ft.recursive(e._observers)),Object.defineProperties(e,ge(t,n)),e._observers.dispatch(i)}function we(e,t){if(r(e[t],"undefined"))throw new Error("Failed to delete "+t+" does not exist");var n=new It({type:t,target:e,method:"delete",oldValue:e[t],newValue:void 0,args:Array.prototype.slice.call(arguments,1)});e[t]&&e[t]._observers&&Oe(e,e[t]._observers),delete e[t],e._observers.dispatch(n)}function ke(e){var t=e.target,r=e.args,n=e.method,i=new It({type:void 0,target:t,method:n,oldValue:void 0,newValue:void 0,args:r});switch(n){case"fill":i.type=r.splice(1),i.oldValue=t.slice(r[1],r[2]);break;case"pop":i.type=t.length-1,i.oldValue=t.slice(t.length-1);break;case"push":i.type=t.length,i.newValue=r;break;case"shift":i.type=0,i.oldValue=t.slice(0,1);break;case"unshift":i.type=0,i.newValue=r;break;case"splice":i.type=r[0],r[1]&&(i.oldValue=t.slice(r[0],r[0]+r[1])),i.newValue=r.slice(2)}t._observers.recursiveExists()&&i.newValue.forEach(function(e){me(e)&&fe(e,Ft.recursive(t._observers))}),i.oldValue&&i.oldValue.forEach(function(e){e&&e._observers&&Oe(t,e._observers)}),Array.prototype[n].apply(t,e.args),t._observers.dispatch(i)}function Ee(e,t){be(e).forEach(function(r){Ee(e[r],t),e[r]._observers&&e[r]._observers.remove(t)})}function Oe(e,t){e._observers.recursive().forEach(function(e){t.remove(e)})}function je(e,t,r){var n=t.transform.bind&&t.transform.bind(e,r),i=void 0;n=n||{node:e,prop:"node"},i=n.node.bindings[n.prop],i&&(console.warn("Removing '"+n.prop+"' binding from node"),i.instance.transform.unbind&&i.instance.transform.unbind(n.node,i),i.observer.disconnect()),n.node.bindings[n.prop]={template:e,target:r,instance:t,observer:void 0},Lt.observer(n.node,n.node.bindings[n.prop],t.recursive)}function _e(e,t){var r=t.toString().split("."),n=r.slice(-1)[0],i=e,o=e;if(""!==t)for(;r.length;)i=o,o=xe(o,r);return{key:n,parent:i,value:o}}function xe(e,t){var r=t.shift();if("undefined"==typeof e[r])throw new Error("Failed to resolve '"+r+"' on target");return e[r]}function Ve(e){for(;e;){if(e.DOMNode)return e.DOMNode.namespaceURI;if(0===e.name.indexOf("svg"))return Ut.svg;e=e.parent instanceof jt?e.parent:!1}return Ut.html}function qe(e){var t=e.indexOf(":"),r=null;return t>=0&&(r=Ut[e.substring(0,t)]||null),r}function Ne(e){"textContent"===e.type&&e.oldValue!==e.newValue&&he(function(){e.target.parent.DOMNode.textContent=e.newValue})}function Pe(e){var t=void 0;if(e.oldValue!==e.newValue)switch(t=e.target.parent,e.method){case"delete":he(function(){t.DOMNode.removeAttributeNS(qe(e.type),e.type)});break;case"add":case"set":he(function(){t.DOMNode.setAttributeNS(qe(e.type),e.type,e.newValue)})}}function Te(e){var t=e.target.parent.DOMNode;switch(e.method){case"push":e.newValue.forEach(function(e){he(function(){t.appendChild(e.DOMNode)})});break;case"pop":e.oldValue&&e.oldValue.length&&he(function(){t.removeChild(e.oldValue[0].DOMNode)});break;case"unshift":e.newValue.forEach(function(e){he(function(){t.insertBefore(e.DOMNode,t.firstChild)})});break;case"splice":e.oldValue&&e.oldValue.length&&he(function(){t.removeChild(e.oldValue[0].DOMNode)}),3===e.args.length&&he(function(){t.insertBefore(e.newValue[0].DOMNode,t.childNodes[e.type])})}}function Ce(e){var t=e.target.parent;"add"===e.method?t.DOMNode.addEventListener(e.type,Ae(t,e.type)):"delete"===e.method&&t.DOMNode.removeEventListener(e.type)}function De(e){var t=void 0,r=void 0,n=void 0,i=void 0;if(e instanceof Et)e.DOMNode=document.createTextNode(e.value.textContent),t=new Nt(Ne),t.observe(e.value),e.observers.push(t);else if(e instanceof jt)e.DOMNode=document.createElementNS(Ve(e),e.name),Object.keys(e.attributes).forEach(function(t){e.DOMNode.setAttributeNS(qe(t),t,e.attributes[t])}),r=new Nt(Pe),n=new Nt(Te),r.observe(e.attributes),n.observe(e.children),e.observers.push(r),e.observers.push(n);else{if(!(e instanceof Ot))throw new Error("Unspecified node instance");e.DOMNode=document.createDocumentFragment(),n=new Nt(Te),n.observe(e.children),e.observers.push(n)}i=new Nt(Ce),i.observe(e.events),e.observers.push(i);for(var o in e.events)e.DOMNode.addEventListener(o,Ae(e,o));e.parent&&e.parent.DOMNode.appendChild(e.DOMNode)}function Se(e){Object.keys(e.bindings).forEach(function(t){var r=e.bindings[t];r.instance.transform.compile&&r.instance.transform.compile(e,r),e.bindings[t]={template:r.template,target:r.target,instance:r.instance,observer:void 0},r.instance.parsed||r.observer.disconnect(),Lt.observer(e,e.bindings[t])})}function Ae(e,t){return function(r){e.events[t].dispatch(r,e)}}function Me(e){if(!e instanceof kt)throw new Error("Template param must be of type Node");if(e.compiled===!0)throw new Error("Specified template is already compiled");var t=e.clone(!0);return Ie(t),t}function Ie(e){"undefined"!=typeof document&&De(e),e.compiled=!0,e.children&&e.children.forEach(Ie),Se(e)}function Fe(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=void 0;if(!e instanceof kt)throw new Error("Node param must be of type Node");return r=e.clone(t),e.compiled===!0&&(r=Me(r)),r}function Le(e,t){if("undefined"==typeof document)throw new Error("transclude requires a document");if(!e.transclude&&!t)throw new Error("unspecified transclusion target");t=e.transclude||t,t.parentNode.insertBefore(e.DOMNode,t),t.parentNode.removeChild(t),e.transclude=void 0}function Ue(e){return e.crossOrigin=zt.protocol!==e.url.protocol||zt.host!==e.url.host,e}function Re(e){return r(e.data,"object")&&e.urlencode&&(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=u(e.data)),r(e.data,"formData")&&delete e.headers["Content-Type"],r(e.data,"object")&&(e.data=JSON.stringify(e.data)),e}function He(e){try{e.data=e.data&&JSON.parse(e.data)}catch(t){console.warn(t)}return e}function ze(e){return e.timeout&&(Bt=setTimeout(function(){e.abort()},e.timeout)),e}function Be(e){return clearTimeout(Bt),e}function Je(e){e.override&&/^(PUT|PATCH|DELETE)$/i.test(e.method)&&(e.headers["X-HTTP-Method-Override"]=e.method,e.method="POST")}function Xe(e){var t={Accept:"application/json, text/plain, */*"};return e.crossOrigin||(t["X-Requested-With"]="XMLHttpRequest"),/^(PUT|POST|PATCH|DELETE)$/i.test(e.method)&&(t["Content-Type"]="application/json"),e.method=e.method.toUpperCase(),e.headers=n(t,e.headers),r(e.data,"object")&&"GET"===e.method&&(n(e.url.query,e.data),delete e.data),e}function $e(e){return new Promise(function(t){var r=new XMLHttpRequest,n={request:e},i=function(){r.abort(),e.aborted=!0},o=function(){n.data=r.responseText,n.status=r.status,n.statusText=r.statusText,n.headers=r.getAllResponseHeaders(),t(n)};e.abort=i,r.timeout=0,r.onload=o,r.onabort=o,r.onerror=o,r.ontimeout=s,r.onprogress=s,r.open(e.method,e.url,!0);for(var a in e.headers)r.setRequestHeader(a,e.headers[a]);r.send(e.data)})}function Ge(e){var t=e.client||$e;return Promise.resolve(t(e)).then(function(e){return e.ok=e.status>=200&&e.status<300,e})}function We(e,t){var n=void 0,i=void 0,o=void 0;r(e.template,"string")&&(e.template=Y(e.template));for(var s in t)e.components[s]=new t[s]({root:!1,selectors:s});if(e.root){if("undefined"!=typeof document)n=Xt.query(e,document);else{if(!e.root instanceof kt)throw new Error("Unspecified virtual root node");n=[e.root]}i=Xt.parse(e,n),o=Xt.compile(e,i),"undefined"!=typeof document?o.forEach(Le):(e.parsed=i,e.compiled=o)}}var Ke,Qe,Ye="undefined"!=typeof process&&process.nextTick?process.nextTick:setTimeout;"undefined"!=typeof window&&window.requestAnimationFrame?(Ke=window.requestAnimationFrame,Qe=window.cancelAnimationFrame):(Ke=setTimeout,Qe=clearTimeout);var Ze=Object.freeze({get paint(){return Ke},get cancelPaint(){return Qe},tick:Ye,capitalize:t,is:r,extend:n,clone:i,match:o,noop:s}),et=Object.freeze({parse:a,format:u,normalize:c}),tt=Object.freeze({parse:l,format:d,normalize:h}),rt=void 0;"undefined"!=typeof document&&(rt=document.createElement("a"));var nt=Object.freeze({query:et,path:tt,parse:f,format:v}),it=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ot=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),st=function $t(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:$t(i,t,r)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(r)},at=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ut=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},ct=[],lt=[],dt={},ht={hash:void 0,root:void 0,reactivate:void 0,otherwise:void 0,post:void 0},ft=void 0,vt=void 0,pt=void 0,mt=void 0,bt=void 0;p();var gt=function(){function e(t){var n=this,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(it(this,e),!t)throw new Error("unspecified segments");if(!r(t,"array"))throw new Error("segments must be an array");this.segments=t,this.requested=i.requested,this.resolved=void 0,this.target=void 0,this.previous=i.previous,this.path=i.path,this.query=i.query,this.replace=i.replace,this.event=i.event,this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return ot(e,[{key:"toString",value:function(){var e=this.segments.slice(1).join("/"),t=this.path?d(e,this.path):e,r=this.query?u(this.query,{query:!0}):"";return t+r}}]),e}(),yt=Object.freeze({reset:p,register:m,go:b,start:g,stop:y,started:w,Request:gt}),wt=function(){function e(){it(this,e),this.listeners=[]}return ot(e,[{key:"add",value:function(e){this.listeners.push(e)}},{key:"remove",value:function(e){return e?this.listeners.splice(this.listeners.indexOf(e),1):void(this.listeners=[])}},{key:"dispatch",value:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];return this.listeners.map(function(t){return t.apply(e,r)})}}]),e}(),kt=function(){function e(){it(this,e),this.compiled=!1,this.transclude=void 0,this.DOMNode=void 0,this.observers=[],this.bindings={},this.events=S(this)}return ot(e,[{key:"destroy",value:function(){var e=this;for(this.compiled=!1,this.transclude=void 0,Ke(function(){e.DOMNode=void 0});this.observers.length;)this.observers.pop().disconnect();for(var t in this.bindings)this.bindings[t].observer.disconnect(),delete this.bindings[t];for(var r in this.events)this.events[r].remove(),delete this.events[r]}},{key:"clone",value:function(){return e.clone(new e,this)}},{key:"on",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];this.events[e]||(this.compiled?this.events.add(e,new wt):(this.events[e]=new wt,this.events[e].capture=r)),this.events[e].add(t)}},{key:"off",value:function(e,t){this.events[e].remove(t),this.events[e]||delete this.events[e]}},{key:"toJSON",value:function(){return this.jsonml}},{key:"valueOf",value:function(){return JSON.stringify(this)}},{key:"toString",value:function(){return this.html}},{key:"jsonml",get:function(){return""}},{key:"html",get:function(){return""}}],[{key:"clone",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];e.transclude=t.transclude;for(var n in t.bindings)e.bindings[n]=t.bindings[n];if(r)for(var i in t.events)e.events[i]=new wt,e.events[i].capture=t.events[i].capture,e.events[i].listeners=t.events[i].listeners.slice()}}]),e}(),Et=function(e){function t(e){it(this,t);var r=ut(this,Object.getPrototypeOf(t).call(this));return r.value={textContent:e},A(r,r.value),r.parent=void 0,r}return at(t,e),ot(t,[{key:"destroy",value:function(){st(Object.getPrototypeOf(t.prototype),"destroy",this).call(this),r(this.parent,"undefined")||this.remove()}},{key:"clone",value:function(){var e=new t(this.value.textContent);return kt.clone(e,this),e}},{key:"remove",value:function(){if(r(this.parent,"undefined"))throw new Error("Failed to remove node");this.parent.children.splice(this.index(),1),this.parent=void 0}},{key:"index",value:function(){return r(this.parent,"undefined")?-1:this.parent.children.indexOf(this)}},{key:"jsonml",get:function(){return this.value.textContent}},{key:"html",get:function(){return this.value.textContent}},{key:"text",get:function(){return this.value.textContent},set:function(e){this.value.textContent=e}}]),t}(kt),Ot=function(e){function t(){it(this,t);var e=ut(this,Object.getPrototypeOf(t).call(this));return e.children=I(e),e}return at(t,e),ot(t,[{key:"destroy",value:function(){st(Object.getPrototypeOf(t.prototype),"destroy",this).call(this);for(var e=this.children.length;e;)e--,this.children[e].destroy()}},{key:"clone",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],r=new t;return e&&this.children.length&&this.children.forEach(function(e){r.append(e.clone(!0))}),kt.clone(r,this,e),r}},{key:"append",value:function(e){if(this.compiled!==e.compiled)throw new Error("Node compiled value does not match");r(e.parent,"undefined")||e.remove(),e.parent=this,this.children.push(e)}},{key:"prepend",value:function(e){if(this.compiled!==e.compiled)throw new Error("Node compiled value does not match");r(e.parent,"undefined")||e.remove(),e.parent=this,this.children.unshift(e)}},{key:"insert",value:function(e,t){if(this.compiled!==e.compiled)throw new Error("Node compiled value does not match");r(e.parent,"undefined")||e.remove(),e.parent=this,this.children.splice(t,0,e)}},{key:"find",value:function(e){for(var t=U(e),n=void 0,i=0,o=this.children.length;o>i;i++){if(t(this.children[i]))return this.children[i];if(!r(this.children[i].find,"undefined")&&(n=this.children[i].find(t),!r(n,"undefined")))return n}}},{key:"filter",value:function(e){for(var t=U(e),n=[],i=0,o=this.children.length;o>i;i++)t(this.children[i])&&n.push(this.children[i]),r(this.children[i].filter,"undefined")||(n=n.concat(this.children[i].filter(t)));return n}},{key:"text",value:function(){return this.filter(R).join("")}},{key:"jsonml",get:function(){throw new Error("Cannot convert to jsonml")}},{key:"html",get:function(){return this.children.map(M).join("")}}]),t}(kt),jt=function(e){function t(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];if(it(this,t),!e)throw new Error("Failed to instantiate Element invalid name specified");var o=ut(this,Object.getPrototypeOf(t).call(this));return o.name=e,o.attributes=H(o,i(r)),o.empty=n,o}return at(t,e),ot(t,[{key:"destroy",value:function(){st(Object.getPrototypeOf(t.prototype),"destroy",this).call(this),r(this.parent,"undefined")||this.remove(),this.attributes=H(this),this.empty=!1}},{key:"clone",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],r=new t(this.name,i(this.attributes));return e&&this.children.length&&this.children.forEach(function(e){r.append(e.clone(!0))}),kt.clone(r,this,e),r}},{key:"remove",value:function(){if(r(this.parent,"undefined"))throw new Error("Failed to remove node");this.parent.children.splice(this.index(),1),this.parent=void 0}},{key:"index",value:function(){return r(this.parent,"undefined")?-1:this.parent.children.indexOf(this)}},{key:"jsonml",get:function(){var e=[];e.push(this.name),r(this.attributes,"empty")===!1&&e.push(i(this.attributes));for(var t=0,n=this.children.length;n>t;t++)e.push(this.children[t].jsonml);return e}},{key:"html",get:function(){var e=this,t=[],r=Object.keys(this.attributes);if(t.push("<"+this.name),r.length&&(t.push(" "),t=t.concat(r.map(function(t){return e.attributes[t]&&(t+='="'+e.attributes[t]+'"'),t}))),this.empty)t.push("/>");else{t.push(">");for(var n=0,i=this.children.length;i>n;n++)t.push(this.children[n].html);t.push("</"+this.name+">")}return t.join("")}},{key:"class",get:function(){return r(this.classList,"undefined")&&(this.classList=new _t(this.attributes,this.compiled)),this.classList}}]),t}(Ot),_t=function(){function e(t,r){it(this,e),this.compiled=r,this.attributes=t}return ot(e,[{key:"toggle",value:function(e){if(z(e))throw new Error("Invalid classname '"+e+"' passed to toggle method");this.contains(e)?this.remove(e):this.add(e)}},{key:"add",value:function(e){if(z(e))throw new Error("Invalid classname '"+e+"' passed to add method");if(!this.contains(e)){if(r(this.attributes["class"],"undefined")&&this.compiled)return void this.attributes.add("class",e);r(this.attributes["class"],"string")&&this.attributes["class"].length&&(e=this.attributes["class"]+" "+e),this.attributes["class"]=e}}},{key:"remove",value:function(e){var t=void 0;if(z(e))throw new Error("Invalid classname '"+e+"' passed to remove method");t=this.index(e),-1!==t&&(this.attributes["class"].length>e.length&&(e=0===t?e+" ":" "+e),this.attributes["class"]=this.attributes["class"].replace(e,""))}},{key:"contains",value:function(e){
if(z(e))throw new Error("Invalid classname '"+e+"' passed to contains method");return-1!==this.index(e)}},{key:"index",value:function(e){if(z(e))throw new Error("Invalid classname '"+e+"' passed to index method");return this.attributes["class"]?this.attributes["class"].split(" ").indexOf(e):-1}}]),e}(),xt=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],Vt=["script"],qt=["fill","pop","push","shift","splice","unshift"],Nt=function(){function e(t){if(it(this,e),r(t,"undefined"))throw new Error("Failed to instantiate missing callback");if(!r(t,"function"))throw new Error("Invalid callback specified");this.callback=t,this._target=void 0,this._config=void 0}return ot(e,[{key:"observe",value:function(e){var t,n=arguments.length<=1||void 0===arguments[1]?{recursive:!1}:arguments[1];if(!re(e))throw new Error("Failed to observe not a valid target");if(r(n.recursive,"undefined"))throw new Error("Invalid config specified");t=new Tt,t.add(this),this._target=e,this._config=n,Z(e,t)}},{key:"disconnect",value:function(){this._target&&(this._config.recursive&&ue(this._target,this),this._target._observers.remove(this)),this._target=void 0,this._config=void 0}}]),e}(),Pt=function Gt(e){it(this,Gt),this.type=e.type,this.target=e.target,this.method=e.method,this.args=e.args,this.newValue=e.newValue,this.oldValue=e.oldValue},Tt=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];it(this,e),this.observers=t}return ot(e,[{key:"dispatch",value:function(e){if(!e instanceof Pt)throw new Error("Invalid record specified");this.observers.forEach(function(t){t.callback(e)})}},{key:"exists",value:function(e){return-1!==this.observers.indexOf(e)}},{key:"add",value:function(e){return this.observers.push(e)}},{key:"remove",value:function(e){var t=this.observers.indexOf(e);return-1!==t&&this.observers.splice(t,1),t}},{key:"recursive",value:function(){return this.observers.filter(function(e){return e._config.recursive})}},{key:"recursiveExists",value:function(){for(var e=0,t=this.observers.length;t>e;e++)if(this.observers[e]._config.recursive)return!0;return!1}}],[{key:"recursive",value:function(t){if(!t instanceof e)throw new Error("Invalid list specified");return new e(t.recursive())}}]),e}(),Ct=[],Dt=void 0,St=void 0;le();var At=["fill","pop","push","shift","splice","unshift"],Mt=function(){function e(t){if(it(this,e),r(t,"undefined"))throw new Error("Failed to instantiate missing callback");if(!r(t,"function"))throw new Error("Invalid callback specified");this.callback=t,this._target=void 0,this._config=void 0}return ot(e,[{key:"observe",value:function(e){var t,n=arguments.length<=1||void 0===arguments[1]?{recursive:!1}:arguments[1];if(!me(e))throw new Error("Failed to observe not a valid target");if(r(n.recursive,"undefined"))throw new Error("Invalid config specified");t=new Ft,t.add(this),this._target=e,this._config=n,fe(e,t)}},{key:"disconnect",value:function(){this._target&&(this._config.recursive&&Ee(this._target,this),this._target._observers.remove(this)),this._target=void 0,this._config=void 0}}]),e}(),It=function Wt(e){it(this,Wt),this.type=e.type,this.target=e.target,this.method=e.method,this.args=e.args,this.newValue=e.newValue,this.oldValue=e.oldValue},Ft=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];it(this,e),this.observers=t}return ot(e,[{key:"dispatch",value:function(e){if(!e instanceof It)throw new Error("Invalid record specified");this.observers.forEach(function(t){t.callback(e)})}},{key:"exists",value:function(e){return-1!==this.observers.indexOf(e)}},{key:"add",value:function(e){return this.observers.push(e)}},{key:"remove",value:function(e){var t=this.observers.indexOf(e);return-1!==t&&this.observers.splice(t,1),t}},{key:"recursive",value:function(){return this.observers.filter(function(e){return e._config.recursive})}},{key:"recursiveExists",value:function(){for(var e=0,t=this.observers.length;t>e;e++)if(this.observers[e]._config.recursive)return!0;return!1}}],[{key:"recursive",value:function(t){if(!t instanceof e)throw new Error("Invalid list specified");return new e(t.recursive())}}]),e}(),Lt=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=n.recursive,o=void 0===i?!1:i,s=n.parsed,a=void 0===s?!1:s;it(this,e),r(t,"function")?this.transform={bind:t,update:t}:this.transform=t,this.recursive=o,this.parsed=a}return ot(e,[{key:"render",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2],i=void 0;if(e.compiled)throw new Error("Requires an uncompiled node");if(i=_e(t,n),r(e,"array"))for(var o=0,s=e.length;s>o;o++)je(e[o],this,i);else je(e,this,i)}}],[{key:"observer",value:function t(e,n){var i=n.target,o=n.instance,t=void 0;r(i.value,"object")||r(i.value,"array")?(t=new Mt(function(t){o.transform.update&&o.transform.update(e,n,t)}),t.observe(i.value)):(t=new Mt(function(t){t.type===i.key&&(i.value=i.parent[i.key],o.transform.update&&o.transform.update(e,n,t))}),t.observe(i.parent)),n.observer=t}}]),e}(),Ut={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/1999/xlink"},Rt=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=arguments[2];it(this,e),this.state=t,this.mutations={},this.post=i,Object.keys(n).forEach(function(e){r.mutations[e]=new wt,r.mutations[e].add(n[e])})}return ot(e,[{key:"dispatch",value:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];var n=t.shift(),i=this.mutations[n];if(!i)throw new Error(n+" mutation does not exist");i.dispatch.apply(i,[this.state].concat(t)),this.post&&this.post.apply(this,[n,this.state].concat(t))}}]),e}(),Ht="undefined"!=typeof window&&window.location||void 0,zt=r(Ht,"undefined")?{}:f(Ht.href),Bt=void 0,Jt=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];it(this,e),this.urlencode=!!t.urlencode,this.override=!!t.override,this.timeout=t.timeout||0,this.headers=t.headers||{},this._url=f(t.url||"")}return ot(e,[{key:"GET",value:function(t){return e.method(this,"GET",t)}},{key:"POST",value:function(t){return e.method(this,"POST",t)}},{key:"PUT",value:function(t){return e.method(this,"PUT",t)}},{key:"PATCH",value:function(t){return e.method(this,"PATCH",t)}},{key:"DELETE",value:function(t){return e.method(this,"DELETE",t)}},{key:"url",get:function(){return v(this._url)}},{key:"query",get:function(){return this._url.query},set:function(e){this._url.query=e}},{key:"path",get:function(){return this._url.path},set:function(e){this._url.path=e}}],[{key:"method",value:function(t,r){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return e.request({urlencode:t.urlencode,override:t.override,timeout:t.timeout,headers:i(t.headers),url:t._url,data:n,method:r})}},{key:"request",value:function(t){return e.interceptors.request.dispatch(t),t.url=v(t.url),Ge(t).then(function(t){return e.interceptors.response.dispatch(t),t.ok?t:Promise.reject(t)})}}]),e}();Jt.interceptors={request:new wt,response:new wt},Jt.interceptors.request.add(ze),Jt.interceptors.request.add(Je),Jt.interceptors.request.add(Re),Jt.interceptors.request.add(Xe),Jt.interceptors.request.add(Ue),Jt.interceptors.response.add(Be),Jt.interceptors.response.add(He);var Xt=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.root,i=void 0===n?!0:n,o=t.components,s=void 0===o?{}:o,a=t.selectors,u=void 0===a?"":a,c=t.template,l=void 0===c?"":c;if(it(this,e),!r(s,"object"))throw new Error("Invalid components type must be an object map");if(!r(l,"string")&&!r(l,"object"))throw new Error("Invalid selectors type must be a string or object");if(!r(l,"string")&&!r(l,"function"))throw new Error("Invalid template type must be a string or function");this.root=i,this.components={},this.selectors=u,this.template=l,We(this,s)}return ot(e,null,[{key:"selector",value:function(e,t){if(r(e.selectors,"string"))return e.selectors;if(e.selectors[t])return e.selectors[t];if(e.selectors.name)return e.selectors.name;throw new Error("Failed to resolve selector "+t)}},{key:"query",value:function(t,r){var n=r.querySelectorAll(e.selector(t,"name"));return n=Array.prototype.slice.call(n),n.forEach(function(r){var n=void 0;t.query&&t.query(r,t);for(var i in t.components)n=t.components[i],e.query(n,r)}),n}},{key:"parse",value:function(t,n){var i=[],o=void 0,s=void 0,a=void 0;return n.forEach(function(n){var u=void 0;t.template?(u=r(t.template,"function")?t.template(n,t):Fe(t.template,!0),t.root?u.transclude=n:(n.parent.insert(u,n.index()),n.destroy())):u=t.root?Y(n):n,u=t.parse&&t.parse(u,t,n)||u,i.push(u);for(var c in t.components)o=t.components[c],s=e.selector(o,"name"),a=u.filter(s),e.parse(o,a)}),i}},{key:"compile",value:function(t,r){var n=[],i=void 0,o=void 0,s=void 0;return r.forEach(function(r){var a=r.compiled?r:Me(r);t.compile&&t.compile(a,t,r),n.push(a);for(var u in t.components)i=t.components[u],o=e.selector(i,"compile"),s=a.filter(o),e.compile(i,s)}),n}}]),e}();e.util=Ze,e.url=nt,e.router=yt,e.parse=Y,e.compile=Me,e.clone=Fe,e.transclude=Le,e.Signal=wt,e.Observer=Nt,e.Store=Rt,e.Http=Jt,e.Text=Et,e.Fragment=Ot,e.Element=jt,e.Bind=Lt,e.Component=Xt});