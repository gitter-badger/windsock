!function(){"use strict";function e(e){return e.replace(/\//g,"")}function t(n,r){if(r)return void(t.module[e(n)]=r);var i=Object.create(null),o=i.exports=Object.create(null);if(n=n.replace(/[\/.]/g,""),!t.module[n])throw new Error("failed to resolve module path: "+n);return t.module[n].call(this,i,o),i.exports}t.module=Object.create(null),t("batch",function(e){function n(e){this._done(),this.callback=e}var r=t("./util").nextPaint;n.prototype={add:function(e){this.queue.push(e),this.requested||(this.id=r(this._run,this),this.requested=!0)},cancel:function(){"undefined"!=typeof window&&window.cancelAnimationFrame&&window.cancelAnimationFrame(this.id),this._done()},_run:function(){this.running=!0;for(var e=0;e<this.queue.length;e++)this.queue[e].call(this);this._done()},_done:function(){this.queue=[],this.requested=!1,this.running=!1,this.id=null,this.callback&&this.callback.call(this)}},e.exports=n}),t("binding",function(e){function n(e){this.options=e||{}}var r=t("./util"),i=t("./signals"),o=r.noop,s=r.merge,a=(r.extend,r.each),u=r.accessors,c=Object.defineProperty;n.prototype={},n.create=function(e){var t=Object.create(Object.prototype,{update:{value:new i,enumerable:!1,writable:!0}});return e=s({view:null,model:null,directive:o},e||Object.create(null)),a(e,function(e,n){c(t,n,u(e,function(e,n){t.update.dispatch(e,n)},{enumerable:!0}))}),t},e.exports=n}),t("directive",function(e){function n(){}var r=t("./util"),i=r.extend;n.extend=function(e){var t=e.prototype.constructor;return t.prototype=i(Object.create(n.prototype),e.prototype),t},n.prototype.init=function(e,t){this.view=e,this.model=t},n.prototype.update=function(){},n.prototype.bind=function(){this.model._observers.add(this.update,this)},n.prototype.destroy=function(){this.model._observers.remove()},e.exports=n}),t("node",function(e){var t=Object.defineProperties,n={fragment:function(e){return Object.create(Object.prototype,{documentNode:{value:e||{},enumerable:!0,writable:!0}})},element:function(e,r,i){return t(n.fragment(i),{name:{value:e,enumerable:!0},attributes:{value:r||{},enumerable:!0}})},text:function(e,t){return Object.create(Object.prototype,{documentNode:{value:t||{},enumerable:!1,writable:!0},toString:{value:function(){return this.value},enumerable:!1},valueOf:{value:function(){return this.value},enumerable:!1},toJSON:{value:function(){return this.value},enumerable:!1},value:{value:e,enumerable:!1,writable:!0,configurable:!0}})}};e.exports=n}),t("observer",function(e){function n(e,t){m(e.object._observers,function(n){n[t].dispatch(e)})}function r(e,t){n(e,"transforms"),t.call(e),n(e,"observers")}function i(e){return y({name:null,object:null,type:null,oldValue:null,transformed:null},e)}function o(e,t,n){return e[t]={get:function(){return n},set:function(e){r(i({name:t,object:this,type:"update",oldValue:n,transformed:e}),function(){this.object._recursive&&c(this.transformed),n=this.transformed})},enumerable:!0,configurable:!0}}function s(e,t){m(Object.getOwnPropertyNames(t),function(n){e._recursive&&c(t[n]),Object.getOwnPropertyDescriptor(t,n).configurable&&o(e,n,t[n])})}function a(e){m(x,function(t){e[t]={value:function(){var e=i({object:this,type:t}),n=Array.prototype.slice.call(arguments);switch(t){case"fill":i.name=n[1],e.oldValue=this.slice(n[1],n[2]);break;case"pop":e.name=this.length-1,e.oldValue=this.slice(this.length-1);break;case"push":e.name=this.length;break;case"shift":e.oldValue=this.slice(0,1);case"unshift":e.name=0;break;case"splice":e.name=n[0],n[1]&&(e.oldValue=this.slice(n[0],n[0]+n[1]))}e.transformed=n,r(e,function(){this._recursive&&m(this.transformed,c),Array.prototype[this.type].apply(this.object,this.transformed)}),e=null}}})}function u(e){g(e,{add:{value:function(e,t){if(!p(this[e],"undefined"))throw new Error("failed to add "+e+" already defined");r(i({name:e,object:this,type:"add",transformed:t}),function(){this.object._recursive&&c(this.transformed),_(this.object,this.name,o({},this.name,this.transformed))})}},"delete":{value:function(e){if(p(this[e],"undefined"))throw new Error("failed to remove "+e+" does not exist");r(i({name:e,object:this,type:"delete",oldValue:this[e]}),function(){this.object[this.name]._observers&&m(this.object[this.name]._observers,function(e){e.unobserve()}),delete this.object[this.name]})}}})}function c(e,t){if(p(e,"null")||!p(e._observers,"undefined")||!p(e,"array")&&!p(e,"object"))return e;var n={_observers:{value:[]},_recursive:{value:p(t,"boolean")?t:!0}};return p(e,"array")||!p(e.length,"undefined")?a(n):u(n),s(n,e),w(e,n),e}function l(e,t){return function(n){b(n,t)&&e.call(this,n)}}function d(){this.observers=new f,this.transforms=new f,this._observed=[]}var h=t("./util"),f=t("./signals"),p=h.is,v=h.bind,m=h.each,b=h.match,y=h.merge,g=h.extend,_=Object.defineProperty,w=Object.defineProperties,x=["fill","pop","push","reverse","shift","sort","splice","unshift"];d.prototype={observe:function(e,t){return c(e),this.observing(e)||(e._observers.push(this),this._observed.push(e)),t?this.observers.add(l(t,{object:e}),e):void 0},transform:function(e,t){return this.observe(e),t?this.transforms.queue(l(t,{object:e}),e):void 0},unobserve:function(e){var t=v(function(e){this.observers.each(function(t){t.context===e&&this.remove(t)}),this.transforms.each(function(t){t.context===e&&this.remove(t)}),e._observers.splice(e._observers.indexOf(this),1),this._observed.splice(this._observed.indexOf(e),1)},this);e?t(e):(this.observers.remove(),this.transforms.remove(),m(this._observed,t))},observing:function(e){return this._observed.indexOf(e)>=0}},e.exports=d}),t("parser",function(e,n){function r(e){for(var t=0,n=d.length;n>t;t++)if(d[t]===e)return!0;return!1}function i(e){return u({type:null},e||{})}function o(e,t){if(e.hasChildNodes())for(var n=e.childNodes,r=0,i=n.length;i>r;r++)parseDOM(n[r],t)}function s(e){var t=i({documentElement:{}}),n=/(([\w\-]+([\s]|[\/>]))|([\w\-]+)=["']([^"']+)["'])/g,r=e.match(n);r.length>1&&(t.attributes={});for(var o=0,s=r.length;s>o;o++){var a=r[o].split("=");0===o?t.name=a[0].replace(/[\/>]/g,"").trim():a.length>1?t.attributes[a[0].trim()]=a[1].replace(/["'>]/g,"").trim():t.attributes[a[0].replace(/[>]/g,"").trim()]=null}return t}var a=t("./util"),u=a.extend,c=a.each,l=a.is,d=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],h=["script"];n.parseDOM=function(e,t){var n;if(-1===h.indexOf(e.nodeName.toLowerCase())){if(e instanceof DocumentFragment)return void o(e,t);if(3===e.nodeType)return t(i({type:"text",textNode:e,value:e.nodeValue}));n=i({documentElement:e,name:e.nodeName.toLowerCase()}),n.void=r(n.name),e.attributes.length&&(n.attributes={},c(e.attributes,function(e){n.attributes[e.name]=e.value})),n.type="start",n.void||t(n),o(e,t),n.attributes&&!n.void&&delete n.attributes,n.type="end",t(n)}},n.parseJSONML=function(e,t){var n,o=1;for((l(e[0],"array")||l(e[0],"object"))&&"undefined"!=typeof e[0].length?parseJSONML(e[0],t):(n=i({documentElement:{},name:e[0]}),e.length>1&&"[object Object]"===e[1].toString()&&(o++,n.attributes=u(Object.create(null),e[1])),n.void=r(n.name),n.type="start",n.void||t(n));o<e.length;)l(e[o],"string")||e[o].value?t(i({type:"text",textNode:{},value:e.value||e[o]})):parseJSONML(e[o],t),o++;"undefined"!=typeof n&&(n.attributes&&!n.void&&delete n.attributes,n.type="end",t(n))},n.parseHTML=function(e,t){var n,o,a;for(e=e.toString().replace(/\n/g,"").replace(/\r/g,"");e;){var u=e.indexOf("<");u>=0?(u>0&&t(i({type:"text",textNode:{},value:e.substring(0,u)})),e=e.substring(u),n=e.indexOf(">")+1,o=e.substring(0,n),a=s(o),a.void="/"===e[o.length-2]||r(a.name),"!"===o[1]?n=e.indexOf("-->")+1:"/"===o[1]||a.void?(a.type="end",t(a)):(a.type="start",t(a)),e=e.substring(n)):(t(i({type:"text",textNode:{},value:e})),e=null)}}}),t("signals",function(e){function n(e,t,n){this.binding=e,this.context=t,this.priority="undefined"!=typeof n?n:0}function r(){this._signals=[]}var i=t("./util"),o=i.each;n.prototype={invoke:function(e){return this.binding?this.binding.apply(this.context,e):void 0}},r.prototype={dispatch:function(){var e=Array.prototype.slice.call(arguments);o(this._signals,function(t){return t.invoke(e)===!1?arguments[3]:void 0})},add:function(e,t,r){for(var i=new n(e,t,r),o=0;o<this._signals.length&&!(i.priority<=this._signals[o].priority);)o++;return this._signals.splice(o,0,i),i},queue:function(e,t){return this.add(e,t,this._signals.length)},remove:function(e){if(!e)return void(this._signals=[]);var t=this._signals.indexOf(e);return-1!==t&&this._signals.splice(t,1),t},each:function(e){o.call(this,this._signals,e)}},r.signal=n,e.exports=r}),t("util",function(e){var t="undefined"!=typeof process&&process.nextTick?process.nextTick:window.setTimeout,n="undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:t,r={nextTick:function(e,n){return t(r.bind(e,n),1)},nextPaint:function(e,t){return n(r.bind(e,t),1)},each:function(e,t){var n,r=Object.create(null);if("undefined"!=typeof e.length){for(var i=0,o=e.length;o>i;i++)if(t.call(this,e[i],i,e,r)===r)return}else{n=Object.keys(e);for(var i=0,o=n.length;o>i;i++)if(t.call(this,e[n[i]],n[i],e,r)===r)return}},traverse:function(e,t){r.each.call(this,e,function(e){var n;return n=t.apply(this,Array.prototype.slice.call(arguments)),(r.is(e,"object")||r.is(e,"array"))&&r.traverse.call(this,e,t),n})},find:function(e,t){var n,i=r.noop;return i=r.is(t,"function")?function(){return t.apply(void 0,Array.prototype.slice.call(arguments))?(n=arguments[2],arguments[3]):void 0}:function(){each(t,function(){})},r.each(e,i),n},extend:function(e){for(var t=1,n=arguments.length;n>t;t++)arguments[t]&&r.each(arguments[t],function(t,n){e[n]=t});return e},merge:function(e){var t=Array.prototype.slice.call(arguments,1);return r.each(t,function(n,i){r.each(e,function(n,r){"undefined"!=typeof t[i][r]&&(e[r]=t[i][r])})}),e},inherit:function(e,t,n){return e.prototype&&t.prototype&&(e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e),e},match:function(e,t){var n=!0;return r.each(t,function(t,r){e[r]!==t&&(n=!1)}),n},bind:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}},is:function(e,t){switch(t){case"empty":return 0==Object.keys(e).length;case"undefined":return"undefined"==typeof e;case"null":return null===e;default:return Object.prototype.toString.call(e)==="[object "+r.capitalize(t)+"]"}},accessors:function(e,t,n){return r.extend({get:function(){return e},set:function(n){var r=e;e=n,t&&t.call(this,n,r)}},n||Object.create(null))},capitalize:function(e){return e.replace(/[a-z]/,function(e){return e.toUpperCase()})},isEmpty:function(e){return 0==Object.keys(e).length},noop:function(){}};e.exports=r}),t("vdom",function(e,n){function r(e){var t="";for(var n in e)t+=" "+n,e[n]&&(t+='="'+e[n]+'"');return t}function i(){var e,t=Array.prototype.slice.call(arguments),n=[];if(!t.length)throw new Error("failed to create vdom, atleast 1 argument required");if(d(t[0],"string"))e=s.element.apply(void 0,t);else if(d(t[0],"object")){try{e=s[t[0].type].apply(t,t.slice(1))}catch(o){throw new Error("failed to create vdom, node type does not exist")}if("element"!==t[0].type)return e}return Object.defineProperties(n,{name:{get:function(){return this._node.name.value},set:function(e){this._node.name.value=e},enumerable:!0},attributes:{get:function(){return this._node.attributes},set:function(e){if(null===this._node.name.value)throw new Error("failed to set attributes on fragment");var t=Object.keys(e);l.call(this,this._node.attributes,function(n,r){return e[r]?(e[r]!==n&&(this._node.attributes[r]=e[r]),void t.splice(t.indexOf(r),1)):void this._node.attributes.delete(r)}),l.call(this,t,function(t){this._node.attributes.add(t,e[t])})}},children:{get:function(){return this._node.children},set:function(e){this._node.children=i(e)}},text:{get:function(){return this.find(function(e){return"undefined"==typeof e.attributes}).join("")},set:function(e){if(this.text.length){var t=this.find(function(e){return"undefined"==typeof e.attributes});l(t,function(t,n){0===n?t.value=e:t.remove()})}else this.append({type:"text"},e)}},parent:{value:null,writable:!0},find:{value:function(e){var t=[],n=e;return d(e,"function")||(n=function(t){return c(t,e)}),l(this.children,function(e){n(e)&&t.push(e),!d(e.children,"undefined")&&e.children.length&&(t=t.concat(e.find(n)))}),t}},clone:{value:function(){return parse(this,a.parseJSONML)}},before:{value:function(){var e=i.apply(this,Array.prototype.slice.call(arguments));if(!this.name)return this.children.unshift(e),e;if(this.parent)return this.parent.children.splice(this.parent.children.indexOf(this),0,e),e;throw new Error("failed to resolve parent")}},after:{value:function(){var e=i.apply(this,Array.prototype.slice.call(arguments));if(!this.name)return this.children.push(e),e;if(this.parent)return this.parent.children.splice(this.parent.children.indexOf(this)+1,0,e),e;throw new Error("failed to resolve parent")}},prepend:{value:function(){return this.children.unshift(i.apply(this,Array.prototype.slice.call(arguments))),this}},append:{value:function(){return this.children.push(i.apply(this,Array.prototype.slice.call(arguments))),this}},remove:{value:function(){return this.parent?(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent):void 0}},jsonml:{value:function(){return JSON.stringify(this)}},html:{value:function(){var e=[];return a.parseJSONML(this,function(t){switch(t.type){case"text":e.push(t.value);break;case"start":e.push("<"+t.name+r(t.attributes)+">");break;case"end":e.push(t.void?"<"+t.name+r(t.attributes)+"/>":"</"+t.name+">")}}),e.join("")}},_compiled:{value:!1,writable:!0},_observer:{value:new u},_node:{value:{name:{value:null},attributes:{},children:[]},configurable:!0}}),n._observer.observe(n._node.name,function(e){null===e.oldValue?n.unshift(e.object[e.name]):n[0]=e.object[e.name]}),n._observer.observe(n._node.attributes,function(e){d(e.object,"empty")&&d(n[1],"object")?n.splice(1,1):n[1]!==e.object&&n.splice(1,0,e.object)}),n._observer.observe(n._node.children,function(e){Array.prototype[e.type].apply(n,e.transformed)}),n.name=e.name,d(e.attributes,"empty")||(n.attributes=e.attributes),n}var o=t("./util"),s=t("./node"),a=t("./parser"),u=t("./observer"),c=o.match,l=(o.merge,o.each),d=o.is;n.parse=function(e){var t,n;return t=d(e,"string")?a.parseHTML:e.nodeName?a.parseDOM:a.parseJSONML,t(e,function(e){switch(e.type){case"text":n.append(e);break;case"start":e.type="element",n=n?n.after(e):i(e);break;case"end":e.void?(e.type="element",n.append(e)):n=n.parent}}),n},n.create=i}),t("view",function(e){function n(){}function r(e){e.name||e.value||!e.length||l(e,n.parser.bind),u.observe(e)}function i(e){switch(this.active||(this.active=this),this.parent||(this.parent=this),e.type){case"text":this.active.push(s.text(e.value,e.textNode));break;case"start":this.parent=this.active,this.active=this.active[this.active.push(s.element(e.name,e.attributes,e.documentElement))-1];break;case"end":e.void?this.active.push(s.element(e.name,e.attributes,e.documentElement)):this.active=this.parent}}var o=t("./util"),s=t("./node"),a=t("./parser"),u=t("./observer"),c=(t("./batch"),o.traverse),r=o.bind,l=o.each,d=o.is;n.parser=a,n.parser.parse=function(e){var t,o=s.fragment(document.createDocumentFragment());return d(e,"string")?t="parseHTML":e.nodeName?(t="parseDOM",e=e.cloneNode()):t="parseJSONML",n.parser[t].call(void 0,e,r(i,o)),delete o.active,delete o.parent,o},n.prototype._compile=function(){c.call(this,this._node,function(e){console.log(e)})},n.prototype._parse=function(e){var t,n,r=new Parser,i="undefined"!=typeof e.nodeName;r.start.add(function(e){e=Node.element(e),d(e.documentNode,"empty")&&!i&&(e.documentNode=document.createElement(e.name),e.attributes&&l(e.attributes,function(t,n){e.documentNode.setAttribute(n,t)})),e.attributes._observers.add(function(e){"remove"==e.method?this.documentNode.removeAttribute(e.args[0]):this.documentNode.setAttribute(e.args[0],e.args[1])},e),this._node?(t.push(e),n=t,t=t[t.length-1]):t=this._node=e,i||t.documentNode.appendChild(e.documentNode)},this),r.content.add(function(e){e=Node.text(e),i||(e.textNode=document.createTextNode(e.nodeValue)),e._observers.add(function(e){console.log("here"),"remove"==e.method||(this.textNode.nodeValue=e.value)},e),t.push(e),i||t.documentNode.appendChild(e.textNode)}),r.end.add(function(e,r){r?(e=Node.element(e),d(e.documentNode,"empty")&&!i&&(e.documentNode=document.createElement(e.name),e.attributes&&l(e.attributes,function(t,n){e.documentNode.setAttribute(n,t)})),t.push(e),i||t.documentNode.appendChild(e.documentNode)):t=n}),r.done.add(function(){r.reset(),r=null}),r.parse(e)},n.prototype.json=function(){return this._node?JSON.stringify(this._node,function(e,t){return t.nodeValue?t.toString():t}):void 0},n.prototype.find=function(e,t){var n=this,r=[];return t=t||this._node,d(e,"object")&&l(t,function(t){var i=!0;t.attributes&&(l(e,function(e,n,r,o){return t.attributes[n]&&t.attributes[n]===e?void 0:(i=!1,o)}),i&&r.push(t),t.children.length&&(r=r.concat(n.find(e,t.children))))}),r},e.exports=n}),t("windsock",function(e){function n(e){this.options=e=e||Object.create(null),this._observer=new i,e.model&&(this.model=e.model),e.view&&(this.view=e.view)}{var r=t("./util"),i=(t("./signals"),t("./parser"),t("./observer")),o=(t("./directive"),t("./binding"),t("./view"),t("./vdom"));r.find,r.inherit,r.extend,r.each,r.is}n.prototype={_setModel:function(e){this._model&&this._observer.unobserve(),this._observer.observe(e),this._model=e},_setView:function(){}},Object.defineProperties(n.prototype,{model:{get:function(){return this._model},set:function(e){this._setModel(e)},enumerable:!0},view:{get:function(){return this._view},set:function(e){this._setView(e)},enumerable:!0}}),n.observer=i,n.vdom=o,e.exports=n}),t("parse/html",function(e){function t(e){var t="";for(var n in e)t+=" "+n,e[n]&&(t+='="'+e[n]+'"');return t}e.exports={start:function(e){this.html.push("<"+e.name+t(e.attributes)+">")},content:function(e){this.html.push(e.value)},end:function(e,n){this.html.push(n?"<"+e.name+t(e.attributes)+"/>":"</"+e.name+">")}}}),window.Windsock=t("windsock")}();